<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lyric Player</title>
    <style>
      body {
        min-height: 100vh;
        margin: 0;
      }
      body > main {
        width: 1200px;
        max-width: 100%;
        margin: 0 auto;
        text-align: center;
      }
      #audio {
        padding: 15px 0;
      }
      #lyric {
        padding: 10% 0;
        font-size: 20px;
      }
    </style>
  </head>

  <body>
    <main>
      <audio id="audio" autoplay controls></audio>
      <div id="lyric"></div>
      <div id="bg"></div>
    </main>
  </body>

  <script src="../dist/music-lyric-utilities.iife.js"></script>
  <script>
    const dom_audio = document.getElementById('audio')
    const dom_lyric = document.getElementById('lyric')

    const ExampleLyric = {
      one: {
        original:
          '[offset:0]\n[00:-1.0]作词: mei\n[00:00.-500]作曲: Henrii/mei\n[00:00.00]クリームソーダとシャンデリア\n[00:03.37]溶けるバニラ\n[00:05.20]今隣で見惚れた\n[00:07.81]不意をついて確かめたい\n[00:10.95]下手な嘘で誤魔化さないでよね\n[00:30.81]S.U.N.day外は晴れ\n[00:33.97]なのに返信待ってだらだらin the bed\n[00:38.67]用は無いから2度も送れない\n[00:42.50]もうちょっと寝ておこう おっおー\n[00:46.19]まだ思わせぶりな態度で未だ惑わせてるのは\n[00:53.51]あなたの事もっと知りたいだけよ本当\n[00:57.50]先の見えない駆け引きで....!\n[01:01.24]クリームソーダとシャンデリア\n[01:04.66]溶けるバニラ\n[01:06.63]今隣で見惚れた\n[01:09.27]不意をついて確かめたい\n[01:12.34]下手な嘘で誤魔化しては\n[01:16.69]クリームソーダにシャンデリア\n[01:20.07]溶けるバニラ\n[01:21.98]君に気づいて欲しい\n[01:24.64]あからさまに目を惹いて\n[01:27.73]本当の事言えたらいいのに\n[01:32.38]なんかないかってきっかけより探しちゃってんのは言い訳\n[01:35.89]使い慣れないセリフを並べて\n[01:37.75]ドラマヒロインなんかを演じてる\n[01:39.83]今日も最低で最高なBad day\n[01:41.93]ばってんなんて丸に変えてく\n[01:43.84]大概間違い\n[01:44.87]まじ問題ない\n[01:45.84]もう興味がない\n[01:46.88]でも会いたい\n[01:47.80]まだ話し足りないフリをしてあなた本当バカなのね\n[01:55.17]私は待ってるのに\n[01:58.74]どうして気づかないのよ\n[02:02.73]クリームソーダとシャンデリア\n[02:06.08]溶けるバニラ\n[02:07.95]まだ話していたいな\n[02:10.65]青い鳥を見てないで\n[02:13.84]わざとらしく誤魔化しては\n[02:18.22]クリームソーダとシャンデリア\n[02:21.47]溶けるバニラ\n[02:23.47]まだ知らないフリかよ\n[02:26.08]教えて明日の予定\n[02:29.15]今度こそは....!\n[02:33.16]いつまでも君がいない事なんて分かってる\n[02:41.12]そろそろ時間かもね\n[02:44.88]月も見え出したから\n[02:48.64]クリームソーダとシャンデリア\n[02:52.14]好きな気持ち打ち明けるためにはさ\n[02:56.77]笑う顔も隠してて\n[02:59.87]あと3秒後目が合いそうだから\n[03:04.20]クリームソーダとシャンデリア\n[03:07.64]あなたと私は結ばれるのかな？\n[03:12.23]2人同時に目が合うその時\n[03:18.45]溶けたバニラ♪',
        translated:
          '[by:清风唔瑜]\n[00:00.00]奶油苏打和霓形灯\n[00:03.37]融化的香草\n[00:05.20]刚才在旁边看的入迷了\n[00:07.81]想出其不意地确认一下\n[00:10.95]不要用拙劣的谎言蒙混过去啊\n[00:30.81]S.U.Nday 外面是晴天\n[00:33.97]可是在床上等着拖拖拉拉的回信\n[00:38.67]因为没有理由，所以不能发第二次了\n[00:42.50]再睡一会儿吧，啊哦~\n[00:46.19]还是故弄玄虚的态度，让我困惑的是\n[00:53.51]关于你的事，我真的只是想知道哦\n[00:57.50]用看不见的未来的策略....！\n[01:01.24]奶油苏打和霓形灯\n[01:04.66]融化的香草\n[01:06.63]刚才在旁边看到入迷了\n[01:09.27]想出其不意的确认一下\n[01:12.34]不要用拙劣的谎言蒙混过去啊！\n[01:16.69]奶油苏打和霓形灯\n[01:20.07]融化的香草\n[01:21.98]希望你能注意到\n[01:24.64]如此明显的吸引注意力\n[01:27.73]如果能说出真心话就好了\n[01:32.38]比起寻找契机 更多的是寻找借口\n[01:35.89]用不习惯的台词\n[01:37.75]演绎电视剧里的女主角\n[01:39.83]今天是最差但也是最好的Bad day\n[01:41.93]把叉号什么的变成圈\n[01:43.84]大概 \n[01:44.87]没错\n[01:45.84]我你已经没有兴趣了\n[01:46.88]但我想见你\n[01:47.80]装作还没说够 你真是个笨蛋\n[01:55.17]我明明在等你\n[01:58.74]为什么你还没察觉到啊喂\n[02:02.73]奶油苏打和霓形灯\n[02:06.08]融化的香草\n[02:07.95]我还没说完呐\n[02:10.65]还没有看到那只青鸟\n[02:13.84]故意蒙混过关\n[02:18.22]奶油苏打和霓形灯\n[02:21.47]融化的香草\n[02:23.47]你还在装作不知道吗\n[02:26.08]告诉我明天的安排\n[02:29.15]这次一定要....!\n[02:33.16]我知道你永远不在我身边\n[02:41.12]差不多是时间了\n[02:44.88]月亮也已经出现了\n[02:48.64]奶油苏打和霓形灯\n[02:52.14]为了倾诉喜欢的心意\n[02:56.77]掩饰起忍不住的笑意\n[02:59.87]再过三秒就睁开眼睛\n[03:04.20]奶油苏打和霓形灯\n[03:07.64]你愿意和我谈一场恋爱嘛？\n[03:12.23]当彼此目光相对的一刻\n[03:18.45]融化的香草',
        roman:
          '[00:00.00]ku rii mu soo da to sha n de ri a\n[00:03.37]to ke ru ba ni ra\n[00:05.20]i ma to na ri de mi to re ta\n[00:07.81]fu i wo tsu i te ta shi ka me ta i\n[00:10.95]he ta na u so de go ma ka sa na i de yo ne\n[00:30.81]S.U.N.dayso to wa ha re\n[00:33.97]na no ni he n shi n ma tte da ra da ra in the bed\n[00:38.67]yo u wa na i ka ra ni do mo o ku re na i\n[00:42.50]mo u cho tto ne te o ko u o tsu oo\n[00:46.19]ma da o mo wa se bu ri na ta i do de i ma da ma do wa se te ru no wa\n[00:53.51]a na ta no ko to mo tto shi ri ta i da ke yo ho n to u\n[00:57.50]sa ki no mi e na i ka ke hi ki de....!\n[01:01.24]ku rii mu soo da to sha n de ri a\n[01:04.66]to ke ru ba ni ra\n[01:06.63]i ma to na ri de mi to re ta\n[01:09.27]fu i wo tsu i te ta shi ka me ta i\n[01:12.34]he ta na u so de go ma ka shi te wa\n[01:16.69]ku rii mu soo da ni sha n de ri a\n[01:20.07]to ke ru ba ni ra\n[01:21.98]ki mi ni ki zu i te ho shi i\n[01:24.64]a ka ra sa ma ni me wo hi i te\n[01:27.73]ho n to u no ko to i e ta ra i i no ni\n[01:32.38]na n ka na i ka tte ki kka ke yo ri sa ga shi cha tte n no wa i i wa ke\n[01:35.89]tsu ka i na re na i se ri fu wo na ra be te\n[01:37.75]do ra ma hi ro i n na n ka wo e n ji te ru\n[01:39.83]kyo u mo sa i te i de sa i ko u na Bad day\n[01:41.93]ba tte n na n te ma ru ni ka e te ku\n[01:43.84]ta i ga i ma chi ga i\n[01:44.87]ma ji mo n da i na i\n[01:45.84]mo u kyo u mi ga na i\n[01:46.88]de mo a i ta i\n[01:47.80]ma da ha na shi ta ri na i fu ri wo shi te a na ta ho n to u ba ka na no ne\n[01:55.17]wa ta shi wa ma tte ru no ni\n[01:58.74]do u shi te ki zu ka na i no yo\n[02:02.73]ku rii mu soo da to sha n de ri a\n[02:06.08]to ke ru ba ni ra\n[02:07.95]ma da ha na shi te i ta i na\n[02:10.65]a o i to ri wo mi te na i de\n[02:13.84]wa za to ra shi ku go ma ka shi te wa\n[02:18.22]ku rii mu soo da to sha n de ri a\n[02:21.47]to ke ru ba ni ra\n[02:23.47]ma da shi ra na i fu ri ka yo\n[02:26.08]o shi e te a shi ta no yo te i\n[02:29.15]ko n do ko so wa....!\n[02:33.16]i tsu ma de mo ki mi ga i na i ko to na n te wa ka tte ru\n[02:41.12]so ro so ro ji ka n ka mo ne\n[02:44.88]tsu ki mo mi e da shi ta ka ra\n[02:48.64]ku rii mu soo da to sha n de ri a\n[02:52.14]su ki na ki mo chi u chi a ke ru ta me ni wa sa\n[02:56.77]wa ra u ka o mo ka ku shi te te\n[02:59.87]a to sa n byo u go me ga a i so u da ka ra\n[03:04.20]ku rii mu soo da to sha n de ri a\n[03:07.64]a na ta to wa ta shi wa mu su ba re ru no ka na?\n[03:12.23]fu ta ri do u ji ni me ga a u so no to ki\n[03:18.45]to ke ta ba ni ra ♪',
        dynamic: '',
      },
    }
    const { Parser, Player } = MusicLyricUtilities

    const lyricParser = new Parser.LyricParser()
    const lyricInfo = lyricParser.parse({
      original: ExampleLyric.one.original,
      translated: ExampleLyric.one.translated,
      roman: ExampleLyric.one.roman,
      dynamic: ExampleLyric.one.dynamic,
    })

    const player = new Player.LyricPlayer({
      onSetLyric(info) {
        console.log('onSetLyric', info)
      },
      onLinePlay(lineNum, info) {
        console.log('onLinePlay', lineNum, info)
        dom_lyric.innerHTML = [info.content.original, info.content.translated, info.content.roman]
          .filter(val => !!val)
          .join('<br /><br />')
      },
    })
    player.updateLyric(lyricInfo)

    dom_audio.onplay = () => {
      player.play(dom_audio.currentTime * 1000)
    }
    dom_audio.onpause = () => {
      player.pause()
    }

    dom_audio.src = 'https://music.163.com/song/media/outer/url?id=2145677987'
  </script>
</html>
